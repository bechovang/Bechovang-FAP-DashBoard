function h(){console.log("FAP Profile Scraper: Bắt đầu cào dữ liệu profile.");function l(t){const e=document.querySelector(`#${t}`);if(e){const o=e.querySelector(".cf_email, .__cf_email__");if(o){const n=o.getAttribute("data-cfemail");if(n)return f(n)}return e.textContent?.trim()||""}return""}function f(t){try{let e="";const o=parseInt(t.substr(0,2),16);for(let n=2;n<t.length;n+=2){const p=parseInt(t.substr(n,2),16)^o;e+=String.fromCharCode(p)}return e}catch(e){return console.log("Không thể decode email:",e),""}}const d=l("ctl00_mainContent_lblFullname"),u=l("ctl00_mainContent_lblRollNumber"),_=l("ctl00_mainContent_lblEmail"),r=l("ctl00_mainContent_lblMajor");let a="FPTU-Unknown";const c=document.body.innerText,i=c.match(/CAMPUS:\s*([^|\n]+)/i)||c.match(/FPTU[^|\n]*/i);i&&(a=i[1]?.trim()||i[0]?.trim()||a);let m="UNKNOWN";if(r){const t=c.match(new RegExp(`${r}_[A-Z0-9_]+`,"i"));t?m=t[0]:m=`${r}_SE_20B`}const s={studentId:u||"UNKNOWN",fullName:d||"Unknown Student",email:_||`${u}@fpt.edu.vn`,campus:a,curriculumCode:m,lastUpdated:new Date().toISOString()};return console.log("FAP Profile Scraper: Cào xong dữ liệu profile.",s),s}const C=h();chrome.runtime.sendMessage({action:"scrapedProfileData",data:C});
