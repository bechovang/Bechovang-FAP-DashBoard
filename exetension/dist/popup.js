(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const c of t)if(c.type==="childList")for(const a of c.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function d(t){const c={};return t.integrity&&(c.integrity=t.integrity),t.referrerPolicy&&(c.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?c.credentials="include":t.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(t){if(t.ep)return;t.ep=!0;const c=d(t);fetch(t.href,c)}})();const o=document.getElementById("scrapeBtn"),i=document.getElementById("downloadAllBtn"),l=document.getElementById("downloadProfileBtn"),u=document.getElementById("downloadExamBtn"),m=document.getElementById("downloadCurriculumBtn"),g=document.getElementById("scrapeWeeklyScheduleBtn"),p=document.getElementById("scrapeExamScheduleBtn"),h=document.getElementById("scrapeGradesBtn"),f=document.getElementById("scrapeAttendanceBtn"),B=document.getElementById("scrapeCurrentPageBtn"),E=document.getElementById("scrapeScheduleJSONBtn"),n=document.getElementById("status");o.addEventListener("click",()=>{o.disabled=!0,n.textContent="Đang bắt đầu...",chrome.runtime.sendMessage({action:"startScraping"},e=>{chrome.runtime.lastError?(n.textContent=`Lỗi: ${chrome.runtime.lastError.message}`,o.disabled=!1):e&&e.status&&(n.textContent=e.status)})});i.addEventListener("click",()=>{chrome.runtime.sendMessage({action:"downloadAll"})});l.addEventListener("click",()=>{chrome.runtime.sendMessage({action:"downloadProfile"})});u.addEventListener("click",()=>{chrome.runtime.sendMessage({action:"downloadExam"})});m.addEventListener("click",()=>{chrome.runtime.sendMessage({action:"downloadCurriculum"})});g.addEventListener("click",()=>{n.textContent="Đang mở trang lịch tuần...",chrome.runtime.sendMessage({action:"scrapeHTMLPage",pageType:"weekly-schedule"})});p.addEventListener("click",()=>{n.textContent="Đang mở trang lịch thi...",chrome.runtime.sendMessage({action:"scrapeHTMLPage",pageType:"exam-schedule"})});h.addEventListener("click",()=>{n.textContent="Đang mở trang điểm...",chrome.runtime.sendMessage({action:"scrapeHTMLPage",pageType:"student-grades"})});f.addEventListener("click",()=>{n.textContent="Đang mở trang điểm danh...",chrome.runtime.sendMessage({action:"scrapeHTMLPage",pageType:"attendance-report"})});B.addEventListener("click",()=>{n.textContent="Đang cào trang hiện tại...",chrome.runtime.sendMessage({action:"scrapeCurrentPage"})});E.addEventListener("click",()=>{n.textContent="Đang mở trang lịch tuần để cào JSON...",chrome.runtime.sendMessage({action:"scrapeScheduleJSON"})});chrome.runtime.onMessage.addListener((e,r,d)=>{e.action==="updateStatus"?n.textContent=e.data:e.action==="scrapingComplete"?(n.textContent="Đã cào dữ liệu thành công!",i.disabled=!1,l.disabled=!1,u.disabled=!1,m.disabled=!1,o.disabled=!1):e.action==="htmlScrapingComplete"?n.textContent=`Đã cào HTML thành công! File: ${e.fileName}`:e.action==="htmlScrapingError"?n.textContent=`Lỗi cào HTML: ${e.error}`:e.action==="scheduleJSONScrapingComplete"?n.textContent=`Đã cào JSON lịch học thành công! File: ${e.fileName}`:e.action==="scheduleJSONScrapingError"&&(n.textContent=`Lỗi cào JSON lịch học: ${e.error}`)});
